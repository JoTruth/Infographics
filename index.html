<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>South Africa's Lost Decade: The Economic Impact (2015-2025)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #EBEBEB; /* TR_OFF-WHITE */
            color: #414042; /* TR_CHARCOAL */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card {
            background-color: #FFFFFF; /* TR_WHITE */
            border: 1px solid #d1d5db; 
        }
        .stat-value {
            font-weight: 900;
            font-size: 4rem;
            line-height: 1;
            color: #84BF43; /* TR_GREEN */
        }
        .flowchart-arrow {
            font-size: 2rem;
            color: #84BF43; /* TR_GREEN */
            line-height: 1;
            transform: translateY(4px);
        }
        .gemini-button {
            background-color: #84BF43;
            color: #FFFFFF;
            font-weight: bold;
            padding: 8px 16px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }
        .gemini-button:hover {
            background-color: #6a9b36;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #84BF43;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #explanationModal {
            background-color: rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12 md:mb-16">
            <h1 class="text-4xl md:text-6xl font-black text-[#414042] mb-4">A Lost Decade</h1>
            <p class="text-lg md:text-xl max-w-4xl mx-auto text-[#7B8C95]">
                From 2015 to 2025, South Africa's economy stagnated, failing to keep pace with population growth. This infographic explores the profound societal impact of near-zero growth, declining incomes, and the resulting triple crisis of unemployment, poverty, and inequality.
            </p>
        </header>

        <main class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

            <section class="md:col-span-2 lg:col-span-3 card rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-bold text-[#414042] mb-4 text-center">The Macroeconomic Story: A Portrait of Stagnation</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center">
                        <h3 class="text-xl font-bold text-[#414042] mb-2">Anemic Real GDP Growth (%)</h3>
                        <div class="chart-container">
                            <canvas id="gdpGrowthChart"></canvas>
                        </div>
                        <p class="text-center mt-4 text-[#7B8C95] text-sm max-w-md">
                            Averaging just 0.7% annually, economic growth has been insufficient to address the nation's pressing needs, lagging far behind emerging market peers.
                        </p>
                        <button class="gemini-button mt-4 explain-button" data-chart-id="gdpGrowthChart">✨ Explain This Chart</button>
                    </div>
                    <div class="flex flex-col items-center">
                        <h3 class="text-xl font-bold text-[#414042] mb-2">GDP Per Capita in Retreat (%)</h3>
                        <div class="chart-container">
                            <canvas id="gdpPerCapitaChart"></canvas>
                        </div>
                        <p class="text-center mt-4 text-[#7B8C95] text-sm max-w-md">
                            With population growth outpacing the economy, real income per person has declined, regressing to 2007 levels and erasing over a decade of progress.
                        </p>
                        <button class="gemini-button mt-4 explain-button" data-chart-id="gdpPerCapitaChart">✨ Explain This Chart</button>
                    </div>
                </div>
            </section>

            <section class="md:col-span-2 lg:col-span-3 card rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-bold text-[#414042] mb-4 text-center">The Human Cost: The Triple Challenge</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
                    <div class="flex flex-col items-center text-center">
                        <h3 class="text-xl font-bold text-[#414042] mb-2">The Unemployment Catastrophe</h3>
                        <p class="stat-value">32.9%</p>
                        <p class="text-lg font-bold text-[#414042] mt-2">Official Rate (Q1 2025)</p>
                        <p class="mt-4 text-[#7B8C95] text-sm">
                            One of the highest unemployment rates in the world, with the crisis most acute among the youth. The economy's inability to create jobs is a primary driver of social distress.
                        </p>
                    </div>
                    <div class="flex flex-col items-center">
                        <h3 class="text-xl font-bold text-[#414042] mb-2 text-center">Youth in Crisis (Ages 15-34)</h3>
                        <div class="chart-container h-64 max-h-64">
                            <canvas id="youthUnemploymentChart"></canvas>
                        </div>
                        <p class="text-center mt-4 text-[#7B8C95] text-sm">
                           Millions of young people are denied the chance to build careers, creating a lost generation and fueling social instability.
                        </p>
                        <button class="gemini-button mt-4 explain-button" data-chart-id="youthUnemploymentChart">✨ Explain This Chart</button>
                    </div>
                    <div class="flex flex-col items-center text-center">
                        <h3 class="text-xl font-bold text-[#414042] mb-2">Poverty & Inequality</h3>
                        <p class="stat-value">63%</p>
                        <p class="text-lg font-bold text-[#414042] mt-2">In Poverty (2024 Est.)</p>
                        <p class="mt-4 text-[#7B8C95] text-sm">
                            Progress in poverty reduction has reversed. With a Gini coefficient of 0.67, South Africa remains one of the most unequal societies on Earth, a legacy entrenched by economic exclusion.
                        </p>
                    </div>
                </div>
            </section>

            <section class="md:col-span-2 lg:col-span-3 card rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-bold text-[#414042] mb-4 text-center">The Vicious Cycle of Stagnation</h2>
                <p class="text-center text-[#7B8C95] mb-6 max-w-3xl mx-auto">
                    The economic crisis is not cyclical but structural. A failure of public infrastructure and governance has deterred investment, creating a self-reinforcing trap that is difficult to escape.
                </p>
                <div class="flex flex-wrap items-center justify-center gap-x-2 gap-y-4 text-center">
                    <div class="p-4 rounded-lg bg-white border border-gray-200">
                        <p class="font-bold text-[#414042]">Infrastructure Collapse</p>
                        <p class="text-xs text-[#7B8C95]">(Energy & Logistics)</p>
                    </div>
                    <div class="flowchart-arrow">→</div>
                    <div class="p-4 rounded-lg bg-white border border-gray-200">
                        <p class="font-bold text-[#414042]">Investment Deterrence</p>
                        <p class="text-xs text-[#7B8C95]">(Low GFCF)</p>
                    </div>
                    <div class="flowchart-arrow">→</div>
                    <div class="p-4 rounded-lg bg-white border border-gray-200">
                        <p class="font-bold text-[#414042]">Low GDP Growth</p>
                        <p class="text-xs text-[#7B8C95]">(Stagnation)</p>
                    </div>
                    <div class="flowchart-arrow">→</div>
                    <div class="p-4 rounded-lg bg-white border border-gray-200">
                        <p class="font-bold text-[#414042]">Social Crisis</p>
                        <p class="text-xs text-[#7B8C95]">(Unemployment)</p>
                    </div>
                     <div class="flowchart-arrow">→</div>
                     <div class="p-4 rounded-lg bg-white border border-gray-200">
                        <p class="font-bold text-[#414042]">Fiscal Strain</p>
                        <p class="text-xs text-[#7B8C95]">(High Debt)</p>
                    </div>
                </div>
            </section>
            
            <section class="card rounded-lg shadow-md p-6 flex flex-col items-center">
                <h3 class="text-xl font-bold text-[#414042] mb-2 text-center">Soaring Public Debt</h3>
                <div class="chart-container">
                    <canvas id="debtToGdpChart"></canvas>
                </div>
                <p class="text-center mt-4 text-[#7B8C95] text-sm">
                    Weak growth and rising social spending have caused the debt-to-GDP ratio to surge, putting fiscal sustainability at risk.
                </p>
                 <button class="gemini-button mt-4 explain-button" data-chart-id="debtToGdpChart">✨ Explain This Chart</button>
            </section>

            <section class="card rounded-lg shadow-md p-6 flex flex-col items-center">
                <h3 class="text-xl font-bold text-[#414042] mb-2 text-center">The "Crowding Out" Effect</h3>
                <div class="chart-container h-64 max-h-64">
                    <canvas id="debtServicingChart"></canvas>
                </div>
                <p class="text-center mt-4 text-[#7B8C95] text-sm">
                    Debt servicing costs now consume over 16% of the budget, "crowding out" essential spending on education, health, and infrastructure needed for future growth.
                </p>
                 <button class="gemini-button mt-4 explain-button" data-chart-id="debtServicingChart">✨ Explain This Chart</button>
            </section>

            <section class="card rounded-lg shadow-md p-6 flex flex-col items-center text-center">
                <h3 class="text-xl font-bold text-[#414042] mb-2">Societal Fractures</h3>
                 <div class="text-6xl mb-4">🚨</div>
                <p class="text-lg font-bold text-[#414042]">High Crime Rates</p>
                <p class="mt-4 text-[#7B8C95] text-sm">
                    Economic exclusion provides a fertile recruiting ground for criminal enterprise. High unemployment is inextricably linked to South Africa's high rates of violent crime, eroding social cohesion and public trust. The justice system is strained, with low conviction rates creating a culture of impunity.
                </p>
            </section>

        </main>
        
        <section id="gemini-policy" class="mt-12 md:mt-16 card rounded-lg shadow-md p-6 text-center">
            <h2 class="text-2xl font-bold text-[#414042] mb-4">From Analysis to Action</h2>
            <p class="text-[#7B8C95] mb-6 max-w-3xl mx-auto">
                The challenges are immense, but not insurmountable. Use the power of AI to explore potential solutions. Click the button below to generate innovative policy ideas aimed at breaking the cycle of stagnation.
            </p>
            <button id="generatePolicyButton" class="gemini-button text-lg">✨ Generate Policy Ideas</button>
            <div id="policy-loader" class="hidden loader"></div>
            <div id="policy-output" class="mt-6 text-left prose max-w-none"></div>
        </section>

        <footer class="text-center mt-12 md:mt-16 card rounded-lg shadow-md p-6">
             <h2 class="text-2xl font-bold text-[#414042] mb-4">The Imperative for Structural Reform</h2>
             <p class="text-[#7B8C95] mb-6 max-w-3xl mx-auto">
                 Breaking the cycle requires bold, sustained implementation of reforms to revive investment, enhance state capacity, and build a more dynamic and inclusive economy.
             </p>
             <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-[#414042]">
                 <div class="text-center">
                     <div class="text-4xl mb-2">⚡</div>
                     <p class="font-bold">Fix Energy</p>
                 </div>
                 <div class="text-center">
                     <div class="text-4xl mb-2">📈</div>
                     <p class="font-bold">Boost Investment</p>
                 </div>
                 <div class="text-center">
                     <div class="text-4xl mb-2">🏛️</div>
                     <p class="font-bold">Enhance State Capacity</p>
                 </div>
                 <div class="text-center">
                     <div class="text-4xl mb-2">👥</div>
                     <p class="font-bold">Create Jobs</p>
                 </div>
             </div>
        </footer>

    </div>
    
    <!-- Explanation Modal -->
    <div id="explanationModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl max-w-2xl w-full p-6 relative">
            <button id="closeModalButton" class="absolute top-2 right-4 text-2xl font-bold text-gray-500 hover:text-gray-800">&times;</button>
            <h3 id="modalTitle" class="text-xl font-bold text-[#414042] mb-4"></h3>
            <div id="modal-loader" class="hidden loader"></div>
            <div id="modal-output" class="prose max-w-none text-gray-700"></div>
        </div>
    </div>


<script>
    const chartInstances = {};

    const themeColors = {
        primary: '#84BF43',   // TR_GREEN
        secondary: '#7B8C95', // TR_GREY
        lightGray: '#EBEBEB', // TR_OFF-WHITE
        darkGray: '#414042',  // TR_CHARCOAL
        labelColor: '#7B8C95'  // TR_GREY
    };

    const defaultChartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                labels: {
                    color: themeColors.darkGray
                }
            },
            tooltip: {
                callbacks: {
                    title: function(tooltipItems) {
                        const item = tooltipItems[0];
                        let label = item.chart.data.labels[item.dataIndex];
                        if (Array.isArray(label)) {
                            return label.join(' ');
                        }
                        return label;
                    }
                }
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    color: themeColors.labelColor,
                    callback: function(value) {
                        return value + '%';
                    }
                },
                grid: {
                    color: themeColors.lightGray
                }
            },
            x: {
                ticks: {
                    color: themeColors.labelColor
                },
                grid: {
                    display: false
                }
            }
        }
    };

    chartInstances['gdpGrowthChart'] = new Chart(document.getElementById('gdpGrowthChart'), {
        type: 'line',
        data: {
            labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025(p)'],
            datasets: [{
                label: 'Real GDP Growth',
                data: [1.3, 0.4, 1.2, 0.8, 0.1, -6.4, 4.9, 1.9, 0.7, 0.6, 1.0],
                borderColor: themeColors.primary,
                backgroundColor: 'rgba(132, 191, 67, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: defaultChartOptions
    });

    chartInstances['gdpPerCapitaChart'] = new Chart(document.getElementById('gdpPerCapitaChart'), {
        type: 'line',
        data: {
            labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025(p)'],
            datasets: [{
                label: 'Real GDP per Capita Growth',
                data: [-0.4, -1.2, -0.4, -0.8, -1.5, -7.5, 3.7, 0.7, -0.5, -0.6, -0.5],
                borderColor: themeColors.primary,
                backgroundColor: 'rgba(132, 191, 67, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: defaultChartOptions
    });

    chartInstances['youthUnemploymentChart'] = new Chart(document.getElementById('youthUnemploymentChart'), {
        type: 'doughnut',
        data: {
            labels: ['Unemployed (15-34)', 'Employed/Other'],
            datasets: [{
                data: [46.1, 53.9],
                backgroundColor: [themeColors.secondary, themeColors.lightGray],
                borderColor: '#FFFFFF',
                borderWidth: 4
            }]
        },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: themeColors.darkGray } }, tooltip: { callbacks: { label: function(context) { return `${context.label}: ${context.raw}%`; } } } } }
    });

    chartInstances['debtToGdpChart'] = new Chart(document.getElementById('debtToGdpChart'), {
        type: 'line',
        data: {
            labels: ['2010', '2015', '2020', '2025(p)', '2027(p)'],
            datasets: [{
                label: 'Gross Govt Debt-to-GDP',
                data: [31.5, 49.1, 69.9, 77, 80],
                borderColor: themeColors.primary,
                backgroundColor: 'rgba(132, 191, 67, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: defaultChartOptions
    });

    chartInstances['debtServicingChart'] = new Chart(document.getElementById('debtServicingChart'), {
        type: 'doughnut',
        data: {
            labels: ['Debt Servicing Costs', 'Other Expenditure'],
            datasets: [{
                data: [16.2, 83.8],
                backgroundColor: [themeColors.secondary, themeColors.primary],
                borderColor: '#FFFFFF',
                borderWidth: 4
            }]
        },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: themeColors.darkGray } }, tooltip: { callbacks: { label: function(context) { return `${context.label}: ${context.raw}% of budget`; } } } } }
    });

    // Gemini API Integration
    const apiKey = ""; // API key will be provided by the environment

    async function callGemini(prompt, loadingElement, outputElement) {
        loadingElement.style.display = 'block';
        outputElement.innerHTML = '';

        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
        
        const payload = {
            contents: [{
                parts: [{ text: prompt }]
            }]
        };

        let response;
        let retries = 3;
        let delay = 1000;

        for (let i = 0; i < retries; i++) {
            try {
                response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (response.ok) break;
            } catch (error) {
                if (i === retries - 1) {
                    outputElement.innerHTML = `<p class="text-red-500">Error: Could not connect to the API after several retries. Please check your connection.</p>`;
                    loadingElement.style.display = 'none';
                    return;
                }
            }
            await new Promise(res => setTimeout(res, delay));
            delay *= 2;
        }


        loadingElement.style.display = 'none';

        if (!response.ok) {
            outputElement.innerHTML = `<p class="text-red-500">Error: Received status ${response.status} from the API. Please try again later.</p>`;
            return;
        }

        try {
            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 && result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                // Simple markdown to HTML
                let html = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/(\n\s*\n)/g, '</p><p>')
                    .replace(/\n/g, '<br>');
                html = `<p>${html}</p>`;
                outputElement.innerHTML = html;
            } else {
                 outputElement.innerHTML = `<p class="text-red-500">Error: Received an empty or invalid response from the API.</p>`;
            }
        } catch (error) {
            outputElement.innerHTML = `<p class="text-red-500">Error: Could not parse the API response. ${error.message}</p>`;
        }
    }

    // Event listener for policy generation
    const generatePolicyButton = document.getElementById('generatePolicyButton');
    const policyLoader = document.getElementById('policy-loader');
    const policyOutput = document.getElementById('policy-output');

    generatePolicyButton.addEventListener('click', () => {
        const prompt = `
            Based on the following summary of South Africa's economic challenges from 2015-2025, generate 5 innovative and actionable policy suggestions to address the situation. For each suggestion, provide a title and a brief rationale.

            Key Challenges:
            - Real GDP Growth: Stagnant, averaging only 0.7% annually.
            - GDP per Capita: Declining, erasing over a decade of progress.
            - Unemployment: Critically high at 32.9%, with youth unemployment over 46%.
            - Public Debt: Soaring to over 77% of GDP.
            - Structural Issues: Failing energy and logistics infrastructure, deterring investment.
            - Social Issues: High poverty (63%), extreme inequality (Gini 0.67), and high crime rates.

            Format the response using markdown with bold titles for each policy.
        `;
        callGemini(prompt, policyLoader, policyOutput);
    });

    // Event listeners for chart explanations
    const explanationModal = document.getElementById('explanationModal');
    const closeModalButton = document.getElementById('closeModalButton');
    const modalTitle = document.getElementById('modalTitle');
    const modalLoader = document.getElementById('modal-loader');
    const modalOutput = document.getElementById('modal-output');

    document.querySelectorAll('.explain-button').forEach(button => {
        button.addEventListener('click', (e) => {
            const chartId = e.target.dataset.chartId;
            const chart = chartInstances[chartId];
            if (!chart) return;

            const chartTitle = chart.canvas.parentElement.previousElementSibling.textContent;
            const chartData = {
                labels: chart.data.labels,
                datasets: chart.data.datasets.map(ds => ({
                    label: ds.label,
                    data: ds.data
                }))
            };

            const prompt = `
                Explain the economic significance for South Africa based on the data in the following chart. 
                Keep the explanation concise and suitable for an infographic summary (about 2-3 paragraphs).

                Chart Title: "${chartTitle}"
                Data: ${JSON.stringify(chartData)}

                Context: This chart is part of an infographic about South Africa's "lost decade" (2015-2025), characterized by economic stagnation, high unemployment, and rising debt.
            `;
            
            modalTitle.textContent = chartTitle;
            explanationModal.style.display = 'flex';
            callGemini(prompt, modalLoader, modalOutput);
        });
    });

    closeModalButton.addEventListener('click', () => {
        explanationModal.style.display = 'none';
        modalOutput.innerHTML = '';
    });
    
    explanationModal.addEventListener('click', (e) => {
        if (e.target === explanationModal) {
            explanationModal.style.display = 'none';
            modalOutput.innerHTML = '';
        }
    });

</script>

</body>
</html>
